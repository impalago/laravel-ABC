$(window).load(function(){$grid=$(".grid"),$grid.masonry({itemSelector:".grid-item",singleMode:!1,isResizable:!0,isAnimated:!0,animationOptions:{queue:!1,duration:500}})}),$(function(){$.material.init(),$(".tt-on").tooltip({placement:"left"}),$(".tt-on-bottom").tooltip({placement:"bottom"}),$(".disabled").on("click",function(t){t.preventDefault()}),$(".nav li").each(function(){var t=$(this).find("a").attr("href");t===window.location.href&&$(this).addClass("active")}),$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}})}),$(function(){}),$(function(){$(".account").on("show.bs.collapse",function(){var t=$(this),e=t.find(".show-info").is(":empty");1==e&&(t.find(".show-info").html('<div class="load-info"><img src="/img/google-load.gif"></div>').fadeIn(),t.find(".account-info").find("span").removeClass("glyphicon-folder-close").addClass("glyphicon-folder-open"),commonProperties.queryAjax(t,function(e){t.find(".show-info").hide().html(e).slideDown()}))}),$("#startDateCont, #endDateCont").datetimepicker({useCurrent:!1,format:"YYYY-MM-DD",showTodayButton:!0,showClose:!0,allowInputToggle:!0}),$("#startDateCont").on("dp.change",function(t){endDate.data("DateTimePicker").minDate(t.date)}),$("#endDateCont").on("dp.change",function(t){startDate.data("DateTimePicker").maxDate(t.date)}),$("#sendData").on("submit",function(t){t.preventDefault(),commonProperties.ajaxPreloader(),commonProperties.queryAjax($(this),function(t){var e=parseInt(t.generalStatistics["ga:avgSessionDuration"]);e=moment.duration(e,"seconds").format("hh:mm:ss",{trim:!1});var o=t.generalStatistics["ga:users"],i=t.generalStatistics["ga:newUsers"],n=t.generalStatistics["ga:sessions"],a=t.generalStatistics["ga:pageviews"],s=n-i;highchartsProperties.basicChart("chartViews","Statistics visits","Views","Date",t.visitByDay),highchartsProperties.pieChart("visitsChart","Visits","Visits",[{name:"New Visitor",y:parseInt(o)},{name:"Returning Visitor",y:parseInt(s),sliced:!0}]),$(".sessions").html(n),$(".pageviews").html(a),$(".sessionDuration").html(e),$(".users").html(o),$(".generalStatistics").fadeIn(),$("#visitsChart, #chartViews").highcharts().reflow()},"json")})});var highchartsProperties={basicChart:function(t,e,o,i,n){new Highcharts.Chart({chart:{renderTo:t},title:{text:e},rangeSelector:{selected:1},yAxis:{title:{text:o}},xAxis:{title:{text:i},type:"datetime"},series:[{name:"Statistics visits",data:n}]})},pieChart:function(t,e,o,i){new Highcharts.Chart({chart:{renderTo:t,plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1,type:"pie"},title:{text:e},tooltip:{pointFormat:"{series.name}: <b>{point.percentage:.1f}%</b>"},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!1},showInLegend:!0}},series:[{name:o,colorByPoint:!0,data:i}]})}},commonProperties={queryAjax:function(t,e,o,i){$.ajax({type:t.data("method")?t.data("method"):t.attr("method"),url:t.data("action")?t.data("action"):t.attr("action"),data:i?i:t.serialize(),dataType:o?o:"html",success:function(t){"function"==typeof e?e(t):location.reload()}})},ajaxPreloader:function(){$(document).ajaxStart(function(){$("#preloader").fadeIn("slow")}).ajaxComplete(function(){$("#preloader").fadeOut("slow")})}};$(function(){$(document).on("click",".update-role",function(t){t.preventDefault(),commonProperties.queryAjax($(this),function(t){$(t).modal("show").on("shown.bs.modal",function(){$.material.checkbox()})})}),$(document).on("click",".deleteRole",function(t){t.preventDefault();var e=$(this),o=e.data("role-id");$.confirm({theme:"hololight",confirmButton:"Yes",cancelButton:"No",title:"Are you sure?",content:"The role will be deleted without possibility to restore.",confirm:function(){commonProperties.queryAjax(e,function(t){e.closest("tr").fadeOut(),$.jGrowl(t,{life:3e3})},"html",{roleId:o})}})}),$(document).on("click",".update-permission",function(t){t.preventDefault(),commonProperties.queryAjax($(this),function(t){$(t).modal("show")})}),$(document).on("click",".deletePermission",function(t){t.preventDefault();var e=$(this),o=e.data("permission-id");$.confirm({theme:"hololight",confirmButton:"Yes",cancelButton:"No",title:"Are you sure?",content:"The permission will be deleted without possibility to restore.",confirm:function(){commonProperties.queryAjax(e,function(t){e.closest("tr").fadeOut(),$.jGrowl(t,{life:3e3})},"html",{roleId:o})}})})}),$(function(){$(document).on("change",".editUserStatus",function(t){t.preventDefault(),commonProperties.queryAjax($(this),function(t){$.jGrowl(t,{life:3e3})})}),$(document).on("click",".deleteUser",function(t){t.preventDefault();var e=$(this),o=e.data("user-id");$.confirm({theme:"hololight",confirmButton:"Yes",cancelButton:"No",title:"Are you sure?",content:"The user will be deleted without possibility to restore.",confirm:function(){commonProperties.queryAjax(e,function(t){e.closest("tr").fadeOut(),$.jGrowl(t,{life:3e3})},"html",{userId:o})}})})}),$(function(){$(document).on("click",".subscriptions-mode",function(t){t.preventDefault(),$(".show-more").html('<img src="/img/load.gif" style="width:30px;">');var e=$(this).data("page-token");$.ajax({url:"/youtube/load-subscriptions/"+e,success:function(t){$(".show-more").remove(),$(".subscriptions").append(t)}})})});